<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>test</title>
	<style>

	h1{
		text-align: center;;
	}

	.btnBox{
		width: 200px;
		text-align: center;
		margin: 0 auto;
	}
	
	#box{
		width: 50px;
		height: 50px;
		background:#abcdef;
		position :absolute;
		top:0px;
		left:0px;
	}

	#big{
		width: 1000px;
		height: 500px;
		border:1px solid #ccc;
		position: relative;
		margin:0 auto;
	}

	#food{
		width: 20px;
		height: 20px;
		background:red;
		position :absolute;
		top:0px;
		right:0px;
	}	

	</style>
</head>
<body onkeydown="return onKey(event)">
	<h1>贪吃蛇</h1>
	<div class="btnBox"><button onclick="start()">开始游戏</button></div>
	<hr>
	<div id="big">
		<div id="box"></div>
	</div>
	<script>

	var statu = 0;
	var box = document.getElementById('box');
	var big = document.getElementById('big');
	var topNum = 0;
	var leftNum = 0;
	var fanx = 0;

	console.log(big.innerHTML + '<div id="food"></div>');
	big.innerHTML += '<div id="food"></div>';
	
	box = document.getElementById('box');
	var width = big.clientWidth;
	var height = big.clientHeight;
	var bWidth = box.clientWidth;
	var bHeight = box.clientHeight;

	// console.log(width);
	// console.log(height);

	var food = new Food;
	console.log(food);
	food.init();

	// var inter =  setInterval(run,50);

	function run(){

		if((bWidth + leftNum) >= width || (bHeight + topNum) >= height || (leftNum == 0 && fanx == 1) || (topNum == 0 && fanx == 3)){
			// alert('die');
			clearInterval(inter);	
		}

		switch(fanx){
			case 0:
				leftNum += 5;
				break;
			case 1:
				leftNum -= 5;
				break;
			case 2:
				topNum += 5;
				break;
			case 3:
				topNum -= 5;
				break;
		}

		// console.log(leftNum);
		// console.log(topNum);
		box.style.left = leftNum + 'px';
		box.style.top = topNum + 'px';

		// if(Math.abs(leftNum - food.fLeft) < (bWidth + food.width) && Math.abs(topNum - food.fTop) < (bHeight + food.height)){
		// if(leftNum)
		if(Math.abs(leftNum - food.fLeft) < (bWidth) && Math.abs(topNum - food.fTop) < (bHeight)){
			food.init();
		}

	}

	function onKey(e){

		if(statu == 0) {
			return;
		}

		var keynum;
		
		// alert(1);
		if(window.event){
			keynum = e.keyCode;
		}else if(e.which){
			keynum = e.which;
		}

		// console.log(keynum);

		var box = document.getElementById('box');
		switch(keynum){
			case 37:
				// leftNum -= 5;
				// box.style.left = leftNum + 'px';
				fanx = 1;
				break;

			case 38:
				// topNum -= 5;
				// // console.log(topNum);
				// box.style.top = topNum + 'px';
				fanx = 3
				break;

			case 39:
				// leftNum += 5;
				// box.style.left = leftNum + 'px';
				fanx = 0;
				break;

			case 40:
				// topNum += 5;
				// box.style.top = topNum + 'px';
				fanx = 2;
				break;
		}
	}

	function Food (){

		this.food = document.getElementById('food');
		this.width = this.food.clientWidth;
		this.height = this.food.clientHeight
		this.fTop = Math.floor(Math.random() * height - this.food.clientHeight);
		this.fLeft = Math.floor(Math.random() * width - this.food.clientWidth);

		this.init = function (){
			this.fTop = Math.floor(Math.random() * (height - this.food.clientHeight));
			this.fLeft = Math.floor(Math.random() * (width - this.food.clientWidth));
			console.log(this.food);
			this.food.style.top = this.fTop + 'px';
			this.food.style.left = this.fLeft + 'px';
		}

	}

	function start(){
		inter =  setInterval(run,50);
		statu = 1;
	}

	</script>
</body>
</html>